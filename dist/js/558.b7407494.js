"use strict";(self["webpackChunkbig_screen"]=self["webpackChunkbig_screen"]||[]).push([[558],{558:function(e,t,a){a.r(t),a.d(t,{default:function(){return X}});var l=a(6768),i=a(5130);const s={class:"container"},o={class:"filter"},n={class:"datePick"},d={class:"tableBox"},r={class:"paginationBox"};function c(e,t,a,c,u,p){const m=(0,l.g2)("el-date-picker"),b=(0,l.g2)("el-table-column"),h=(0,l.g2)("el-button"),g=(0,l.g2)("el-table"),D=(0,l.g2)("el-pagination"),k=(0,l.g2)("add-device-view");return(0,l.uX)(),(0,l.CE)("div",s,[(0,l.Lk)("div",o,[(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[t[6]||(t[6]=(0,l.Lk)("span",{class:"label"},"设备ID：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>u.filterData.monitorId=e),placeholder:"请输入",class:"inp"},null,512),[[i.Jo,u.filterData.monitorId]])]),(0,l.Lk)("li",null,[t[7]||(t[7]=(0,l.Lk)("span",{class:"label"},"质保日期：",-1)),(0,l.Lk)("div",n,[(0,l.bF)(m,{modelValue:u.filterData.warrantyDate,"onUpdate:modelValue":t[1]||(t[1]=e=>u.filterData.warrantyDate=e),"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},null,8,["modelValue"])])]),(0,l.Lk)("li",null,[(0,l.Lk)("button",{class:"btn",onClick:t[2]||(t[2]=(...e)=>p.handleQuery&&p.handleQuery(...e))},"查询"),(0,l.Lk)("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>p.handleReset&&p.handleReset(...e))},"重置")])]),(0,l.Lk)("div",{class:"addBtn",onClick:t[4]||(t[4]=e=>u.showAdd=!0)},"新增设备")]),(0,l.Lk)("div",d,[(0,l.bF)(g,{data:u.tableData,style:{width:"100%"}},{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"index",align:"center",label:"序号","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"province",align:"center",label:"省","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"city",align:"center",label:"市","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"district",align:"center",label:"区/县","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"type",align:"center",label:"设备型号","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"factoryId",align:"center",label:"出厂编号","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"factoryDate",align:"center",label:"出厂日期","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"debugDate",align:"center",label:"调试日期","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"client",align:"center",label:"客户名称","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"monitorId",align:"center",label:"设备ID","show-overflow-tooltip":""}),(0,l.bF)(b,{prop:"address",align:"center",label:"操作",width:"125"},{default:(0,l.k6)((e=>[(0,l.bF)(h,{onClick:t=>p.handleClick(e.row),type:"text",size:"small"},{default:(0,l.k6)((()=>t[8]||(t[8]=[(0,l.eW)("编辑 ")]))),_:2},1032,["onClick"]),(0,l.bF)(h,{type:"text",size:"small",onClick:t=>p.handleDelete(e.row)},{default:(0,l.k6)((()=>t[9]||(t[9]=[(0,l.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),(0,l.Lk)("div",r,[(0,l.bF)(D,{"current-page":u.filterData.pn,onSizeChange:p.handleSizeChange,onCurrentChange:p.handleCurrentChange,total:u.filterData.total,background:"",layout:"total, prev, pager, next"},null,8,["current-page","onSizeChange","onCurrentChange","total"])]),u.showAdd?((0,l.uX)(),(0,l.Wv)(k,{key:0,onDoSubmit:t[5]||(t[5]=t=>p.closeDialog(e.idx)),data:u.editData},null,8,["data"])):(0,l.Q3)("",!0)])}const u={class:"addEquipment"},p={class:"addBox"},m={class:"formData"},b={class:"elSelect small"},h={class:"elSelect small"},g={class:"elSelect small"},D={class:"datePick"},k={class:"datePick"},v=["disabled"],y={class:"datePick"},L={class:"btns"};function f(e,t,a,s,o,n){const d=(0,l.g2)("el-option"),r=(0,l.g2)("el-select"),c=(0,l.g2)("el-date-picker");return(0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("div",p,[t[24]||(t[24]=(0,l.Lk)("h3",{class:"title"},"新增质保设备",-1)),(0,l.Lk)("div",m,[(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,[t[13]||(t[13]=(0,l.Lk)("div",{class:"label"},"省：",-1)),(0,l.Lk)("div",b,[(0,l.bF)(r,{modelValue:o.submitData.province,"onUpdate:modelValue":t[0]||(t[0]=e=>o.submitData.province=e),"collapse-tags":"",placeholder:"请选择",onChange:n.provinceChange},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.provincesList,(e=>((0,l.uX)(),(0,l.Wv)(d,{key:e.provinceId,label:e.province,value:e.provinceId},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])]),(0,l.Lk)("li",null,[t[14]||(t[14]=(0,l.Lk)("div",{class:"label"},"市",-1)),(0,l.Lk)("div",h,[(0,l.bF)(r,{modelValue:o.submitData.city,"onUpdate:modelValue":t[1]||(t[1]=e=>o.submitData.city=e),"collapse-tags":"",placeholder:"请选择",onChange:n.cityChange},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.citiesList,(e=>((0,l.uX)(),(0,l.Wv)(d,{key:e.cityId,label:e.city,value:e.cityId},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])]),(0,l.Lk)("li",null,[t[15]||(t[15]=(0,l.Lk)("div",{class:"label"},"区/县",-1)),(0,l.Lk)("div",g,[(0,l.bF)(r,{modelValue:o.submitData.district,"onUpdate:modelValue":t[2]||(t[2]=e=>o.submitData.district=e),"collapse-tags":"",placeholder:"请选择"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.areasList,(e=>((0,l.uX)(),(0,l.Wv)(d,{key:e.areaId,label:e.area,value:e.areaId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),(0,l.Lk)("li",null,[t[16]||(t[16]=(0,l.Lk)("div",{class:"label"},"设备型号：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>o.submitData.type=e),name:"",id:"",class:"inp",placeholder:"请输入"},null,512),[[i.Jo,o.submitData.type]])]),(0,l.Lk)("li",null,[t[17]||(t[17]=(0,l.Lk)("div",{class:"label"},"出厂编号：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>o.submitData.factoryId=e),name:"",id:"",class:"inp",placeholder:"请输入"},null,512),[[i.Jo,o.submitData.factoryId]])]),(0,l.Lk)("li",null,[t[18]||(t[18]=(0,l.Lk)("div",{class:"label"},"出厂日期",-1)),(0,l.Lk)("div",D,[(0,l.bF)(c,{modelValue:o.submitData.factoryDate,"onUpdate:modelValue":t[5]||(t[5]=e=>o.submitData.factoryDate=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择日期时间"},null,8,["modelValue"])])]),(0,l.Lk)("li",null,[t[19]||(t[19]=(0,l.Lk)("div",{class:"label"},"调试日期：",-1)),(0,l.Lk)("div",k,[(0,l.bF)(c,{modelValue:o.submitData.debugDate,"onUpdate:modelValue":t[6]||(t[6]=e=>o.submitData.debugDate=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择日期时间"},null,8,["modelValue"])])]),(0,l.Lk)("li",null,[t[20]||(t[20]=(0,l.Lk)("div",{class:"label"},"客户名称：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>o.submitData.client=e),name:"",id:"",class:"inp",placeholder:"请输入"},null,512),[[i.Jo,o.submitData.client]])]),(0,l.Lk)("li",null,[t[21]||(t[21]=(0,l.Lk)("div",{class:"label"},"设备ID：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=e=>o.submitData.monitorId=e),disabled:a.data?.monitorId,name:"",id:"",class:"inp",placeholder:"请输入"},null,8,v),[[i.Jo,o.submitData.monitorId]])]),(0,l.Lk)("li",null,[t[22]||(t[22]=(0,l.Lk)("div",{class:"label"},"质保期：",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=e=>o.submitData.warrantySpan=e),name:"",id:"",class:"inp",placeholder:"请输入"},null,512),[[i.Jo,o.submitData.warrantySpan]])]),(0,l.Lk)("li",null,[t[23]||(t[23]=(0,l.Lk)("div",{class:"label"},"质保到期日",-1)),(0,l.Lk)("div",y,[(0,l.bF)(c,{modelValue:o.submitData.warrantyDate,"onUpdate:modelValue":t[10]||(t[10]=e=>o.submitData.warrantyDate=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"选择日期时间"},null,8,["modelValue"])])])])]),(0,l.Lk)("div",L,[(0,l.Lk)("div",{class:"btn",onClick:t[11]||(t[11]=e=>n.doSubmit(1))},"取消"),(0,l.Lk)("div",{class:"btn",onClick:t[12]||(t[12]=e=>n.doSubmit(2))},"完成")])])])}var w=a(1184);const C=e=>w.A.get("/monitor/infoPage",{params:e}),I=e=>w.A.post("/monitor/infoAdd",e),V=e=>w.A.post("/monitor/infoUpdate",e),F=e=>w.A.post("/monitor/infoDelete/"+e.id),S=e=>w.A.get("/common/provinces",{params:e}),Y=e=>w.A.get("/common/cities/"+e.provinceId),A=e=>w.A.get("/common/areas/"+e.cityId);var x={props:{data:{type:Object,default:()=>{}}},data(){return{value1:"",value2:"",value3:"",provincesList:[],citiesList:[],areasList:[],submitData:{id:"",monitorId:"",client:"",type:"",province:"",city:"",district:"",factoryId:"",factoryDate:"",debugDate:"",warrantyDate:"",warrantySpan:""}}},mounted(){this.data?.id&&Object.assign(this.submitData,this.data),this.submitData.id=this.data?.id,this.getProvincesList()},watch:{"submitData.factoryDate":"calculateWarrantySpan","submitData.warrantyDate":"calculateWarrantySpan"},methods:{calculateWarrantySpan(){const{factoryDate:e,warrantyDate:t}=this.submitData;if(e&&t){const a=new Date(e),l=new Date(t),i=12*(l.getFullYear()-a.getFullYear())+(l.getMonth()-a.getMonth());this.submitData.warrantySpan=i>0?i:0}},doSubmit(e){if(2==e){let t=!1;for(const[e]of Object.entries(this.submitData))this.submitData[e]||"id"==e||(t=!0);if(t)return void alert("请填写完整内容");this.data?.id?V(this.submitData).then((t=>{200==t.code?(this.$emit("doSubmit",e),this.$message({message:"操作成功",type:"success"})):this.$message({message:t.message,type:"warning"})})):I(this.submitData).then((t=>{200==t.code?(this.$emit("doSubmit",e),this.$message({message:"操作成功",type:"success"})):this.$message({message:t.message,type:"warning"})}))}else this.$emit("doSubmit",e)},getProvincesList(){S().then((e=>{200==e.code?this.provincesList=e.data:alert(e.message)}))},provinceChange(){Y({provinceId:this.submitData.province}).then((e=>{200==e.code?this.citiesList=e.data:alert(e.message)}))},cityChange(){A({cityId:this.submitData.city}).then((e=>{console.log(e),200==e.code?this.areasList=e.data:alert(e.message)}))}}},U=a(1241);const _=(0,U.A)(x,[["render",f],["__scopeId","data-v-4b2dad34"]]);var $=_,M={components:{addDeviceView:$},data(){return{value1:"",region:"",showAdd:!1,tableData:[],filterData:{pn:1,size:10,total:0,warrantyDate:"",id:""},editData:{}}},mounted(){this.getList()},methods:{getList(){C(this.filterData).then((e=>{200==e.code?(this.tableData=e.data.records,this.filterData.total=e.data.total,this.filterData.pn=e.data.current):this.$message({message:"获取数据失败",type:"warning"})}))},handleDelete(e){F({id:e.monitorId}).then((e=>{console.log(e),200==e.code?(this.$message({message:"删除成功",type:"success"}),this.getList()):this.$message({message:"删除失败",type:"warning"})}))},handleQuery(){this.getList()},handleReset(){this.filterData.warrantyDate="",this.filterData.monitorId=""},onSubmit(){console.log("submit!")},handleSizeChange(e){console.log(`每页 ${e} 条`)},handleCurrentChange(e){this.filterData.pn=e,this.getList()},handleClick(e){this.editData=e,this.showAdd=!0,console.log(e)},closeDialog(){this.showAdd=!1,this.editData=null,this.filterData.pn=1,this.filterData.size=10,this.getList()}}};const W=(0,U.A)(M,[["render",c],["__scopeId","data-v-8d6bb0b4"]]);var X=W}}]);
//# sourceMappingURL=558.b7407494.js.map